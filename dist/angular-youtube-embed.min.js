/*
  angular-youtube-mb v1.1.1
  https://github.com/brandly/angular-youtube-embed
*/
angular.module("youtube-embed",["ng"]).service("youtubeEmbedUtils",["$window","$rootScope",function(e,t){function r(e,t){return e.indexOf(t)>-1}function a(){t.$apply(function(){i.ready=!0})}var i={},n=/https?:\/\/(?:[0-9A-Z-]+\.)?(?:youtu\.be\/|youtube(?:-nocookie)?\.com\S*[^\w\s-])([\w-]{11})(?=[^\w-]|$)(?![?=&+%\w.-]*(?:['"][^<>]*>|<\/a>))[?=&+%\w.-]*/gi,o=/t=(\d+)[ms]?(\d+)?s?/;return i.getIdFromURL=function(e){var t=e.replace(n,"$1");if(r(t,";")){var a=t.split(";");if(r(a[1],"%")){var i=decodeURIComponent(a[1]);t=("http://youtube.com"+i).replace(n,"$1")}else t=a[0]}else r(t,"#")&&(t=t.split("#")[0]);return t},i.getTimeFromURL=function(e){e=e||"";var t=e.match(o);if(!t)return 0;var a=t[0],i=t[1],n=t[2];return"undefined"!=typeof n?(n=parseInt(n,10),i=parseInt(i,10)):r(a,"m")?(i=parseInt(i,10),n=0):(n=parseInt(i,10),i=0),n+60*i},i.ready=!1,"undefined"==typeof YT?e.onYouTubeIframeAPIReady=a:YT.loaded?i.ready=!0:YT.ready(a),i}]).directive("youtubeVideo",["youtubeEmbedUtils",function(e){var t=1,r={"-1":"unstarted",0:"ended",1:"playing",2:"paused",3:"buffering",5:"queued"},a="youtube.player.";return{restrict:"EA",scope:{videoId:"=?",videoUrl:"=?",player:"=?",playerVars:"=?",playerHeight:"=?",playerWidth:"=?"},link:function(i,n,o){function l(){var e=Array.prototype.slice.call(arguments);i.$apply(function(){i.$emit.apply(i,e)})}function d(e){var t=r[e.data];"undefined"!=typeof t&&l(a+t,i.player,e),i.$apply(function(){i.player.currentState=t})}function u(e){l(a+"ready",i.player,e)}function y(e){l(a+"error",i.player,e)}function p(){var e=angular.copy(i.playerVars);e.start=e.start||i.urlStartTime,e.autoplay=!0;var t=new YT.Player(c,{height:i.playerHeight,width:i.playerWidth,videoId:i.videoId,playerVars:e,events:{onReady:u,onStateChange:d,onError:y}});return t.id=c,t}i.utils=e;var c=o.playerId||n[0].id||"unique-youtube-embed-id-"+t++;n[0].id=c,i.playerHeight=i.playerHeight||390,i.playerWidth=i.playerWidth||640,i.playerVars=i.playerVars||{},i.loadPlayer=function(){(i.videoId||i.playerVars.list)&&(i.player&&"function"==typeof i.player.destroy&&i.player.destroy(),i.player=p())};var s=i.$watch(function(){return i.utils.ready&&("undefined"!=typeof i.videoUrl||"undefined"!=typeof i.videoId||"undefined"!=typeof i.playerVars.list)},function(e){e&&(s(),console.log("ready"),"undefined"!=typeof i.videoUrl?i.$watch("videoUrl",function(e){i.videoId=i.utils.getIdFromURL(e),i.urlStartTime=i.utils.getTimeFromURL(e)}):"undefined"!=typeof i.videoId?i.$watch("videoId",function(){i.urlStartTime=null}):i.$watch("playerVars.list",function(){i.urlStartTime=null,loadPlayer()}))});i.$watchCollection(["playerHeight","playerWidth"],function(){i.player&&i.player.setSize(i.playerWidth,i.playerHeight)}),i.$on("$destroy",function(){i.player&&i.player.destroy()})},template:'<div class="wrap-youtube-placeholder"><img class="youtube-thumb" ng-click="loadPlayer();" src="//i.ytimg.com/vi/{{videoId}}/hqdefault.jpg"><div ng-click="loadPlayer();" class="play-button"></div></div>'}}]);